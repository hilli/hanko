"use strict";(self.webpackChunk_teamhanko_docs=self.webpackChunk_teamhanko_docs||[]).push([[35],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>d});var a=n(7294);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},o=Object.keys(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(a=0;a<o.length;a++)n=o[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var s=a.createContext({}),u=function(e){var t=a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},c=function(e){var t=u(e.components);return a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},m=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),m=u(n),d=r,h=m["".concat(s,".").concat(d)]||m[d]||p[d]||o;return n?a.createElement(h,i(i({ref:t},c),{},{components:n})):a.createElement(h,i({ref:t},c))}));function d(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=n.length,i=new Array(o);i[0]=m;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=n[u];return a.createElement.apply(null,i)}return a.createElement.apply(null,n)}m.displayName="MDXCreateElement"},5162:(e,t,n)=>{n.d(t,{Z:()=>i});var a=n(7294),r=n(6010);const o="tabItem_Ymn6";function i(e){let{children:t,hidden:n,className:i}=e;return a.createElement("div",{role:"tabpanel",className:(0,r.Z)(o,i),hidden:n},t)}},5488:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(7462),r=n(7294),o=n(6010),i=n(2389),l=n(7392),s=n(7094),u=n(2466);const c="tabList__CuJ",p="tabItem_LNqP";function m(e){var t;const{lazy:n,block:i,defaultValue:m,values:d,groupId:h,className:k}=e,f=r.Children.map(e.children,(e=>{if((0,r.isValidElement)(e)&&"value"in e.props)return e;throw new Error(`Docusaurus error: Bad <Tabs> child <${"string"==typeof e.type?e.type:e.type.name}>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.`)})),g=d??f.map((e=>{let{props:{value:t,label:n,attributes:a}}=e;return{value:t,label:n,attributes:a}})),b=(0,l.l)(g,((e,t)=>e.value===t.value));if(b.length>0)throw new Error(`Docusaurus error: Duplicate values "${b.map((e=>e.value)).join(", ")}" found in <Tabs>. Every value needs to be unique.`);const v=null===m?m:m??(null==(t=f.find((e=>e.props.default)))?void 0:t.props.value)??f[0].props.value;if(null!==v&&!g.some((e=>e.value===v)))throw new Error(`Docusaurus error: The <Tabs> has a defaultValue "${v}" but none of its children has the corresponding value. Available values are: ${g.map((e=>e.value)).join(", ")}. If you intend to show no default tab, use defaultValue={null} instead.`);const{tabGroupChoices:y,setTabGroupChoices:N}=(0,s.U)(),[w,x]=(0,r.useState)(v),j=[],{blockElementScrollPositionUntilNextRender:E}=(0,u.o5)();if(null!=h){const e=y[h];null!=e&&e!==w&&g.some((t=>t.value===e))&&x(e)}const C=e=>{const t=e.currentTarget,n=j.indexOf(t),a=g[n].value;a!==w&&(E(t),x(a),null!=h&&N(h,String(a)))},I=e=>{var t;let n=null;switch(e.key){case"Enter":C(e);break;case"ArrowRight":{const t=j.indexOf(e.currentTarget)+1;n=j[t]??j[0];break}case"ArrowLeft":{const t=j.indexOf(e.currentTarget)-1;n=j[t]??j[j.length-1];break}}null==(t=n)||t.focus()};return r.createElement("div",{className:(0,o.Z)("tabs-container",c)},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,o.Z)("tabs",{"tabs--block":i},k)},g.map((e=>{let{value:t,label:n,attributes:i}=e;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:w===t?0:-1,"aria-selected":w===t,key:t,ref:e=>j.push(e),onKeyDown:I,onClick:C},i,{className:(0,o.Z)("tabs__item",p,null==i?void 0:i.className,{"tabs__item--active":w===t})}),n??t)}))),n?(0,r.cloneElement)(f.filter((e=>e.props.value===w))[0],{className:"margin-top--md"}):r.createElement("div",{className:"margin-top--md"},f.map(((e,t)=>(0,r.cloneElement)(e,{key:t,hidden:e.props.value!==w})))))}function d(e){const t=(0,i.Z)();return r.createElement(m,(0,a.Z)({key:String(t)},e))}},3148:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>c,contentTitle:()=>s,default:()=>d,frontMatter:()=>l,metadata:()=>u,toc:()=>p});var a=n(7462),r=(n(7294),n(3905)),o=n(5488),i=n(5162);const l={title:"Next.js + Hanko",sidebar_label:"Next.js",keywords:["next","nextjs"],sidebar_custom_props:{docCardIconName:"nextjs-dark"}},s="Next.js",u={unversionedId:"guides/next",id:"guides/next",title:"Next.js + Hanko",description:"In this guide you will learn how to add authentication to your Next.js application using the Hanko custom element.",source:"@site/docs/guides/next.mdx",sourceDirName:"guides",slug:"/guides/next",permalink:"/guides/next",draft:!1,tags:[],version:"current",frontMatter:{title:"Next.js + Hanko",sidebar_label:"Next.js",keywords:["next","nextjs"],sidebar_custom_props:{docCardIconName:"nextjs-dark"}},sidebar:"docs",previous:{title:"React",permalink:"/guides/react"},next:{title:"Vue",permalink:"/guides/vue"}},c={},p=[{value:"Install dependencies",id:"install-dependencies",level:2},{value:"Import &amp; use custom element",id:"import--use-custom-element",level:2},{value:"Defining login callbacks",id:"defining-login-callbacks",level:2},{value:"UI customization",id:"ui-customization",level:2},{value:"Backend request authentication",id:"backend-request-authentication",level:2}],m={toc:p};function d(e){let{components:t,...n}=e;return(0,r.kt)("wrapper",(0,a.Z)({},m,n,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h1",{id:"nextjs"},"Next.js"),(0,r.kt)("p",null,"In this guide you will learn how to add authentication to your Next.js application using the Hanko custom element."),(0,r.kt)("h2",{id:"install-dependencies"},"Install dependencies"),(0,r.kt)("p",null,"Install the ",(0,r.kt)("inlineCode",{parentName:"p"},"@teamhanko/hanko-elements")," package:"),(0,r.kt)(o.Z,{mdxType:"Tabs"},(0,r.kt)(i.Z,{value:"npm",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"npm install @teamhanko/hanko-elements\n"))),(0,r.kt)(i.Z,{value:"yarn",label:"Yarn",mdxType:"TabItem"},(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-shell"},"yarn add @teamhanko/hanko-elements\n")))),(0,r.kt)("h2",{id:"import--use-custom-element"},"Import & use custom element"),(0,r.kt)("p",null,"Import the ",(0,r.kt)("inlineCode",{parentName:"p"},"register")," function from ",(0,r.kt)("inlineCode",{parentName:"p"},"@teamhanko/hanko-elements/hanko-auth")," in the component where you want to use the\nHanko custom element. Call ",(0,r.kt)("inlineCode",{parentName:"p"},"register")," to register the ",(0,r.kt)("inlineCode",{parentName:"p"},"<hanko-auth>")," element with the browser's\n",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/de/docs/Web/API/CustomElementRegistry"},(0,r.kt)("inlineCode",{parentName:"a"},"CustomElementRegistry")),".\nThen use the ",(0,r.kt)("inlineCode",{parentName:"p"},"<hanko-auth>")," element in your JSX."),(0,r.kt)("admonition",{type:"info"},(0,r.kt)("p",{parentName:"admonition"},"When adding the ",(0,r.kt)("inlineCode",{parentName:"p"},"<hanko-auth>")," element to your JSX you must provide the URL of the Hanko API via the ",(0,r.kt)("inlineCode",{parentName:"p"},"api"),"\nattribute. If you are using ",(0,r.kt)("a",{parentName:"p",href:"https://cloud.hanko.io"},"Hanko Cloud"),", you can find the API URL on your project dashboard.\nIf you are self-hosting you need to provide the URL of your running Hanko backend.")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="HankoAuth.jsx" showLineNumbers',title:'"HankoAuth.jsx"',showLineNumbers:!0},'import { register } from "@teamhanko/hanko-elements/hanko-auth";\n\nconst api = process.env.NEXT_PUBLIC_HANKO_API!;\nconst lang = process.env.NEXT_PUBLIC_HANKO_LANG;\n\nexport default function HankoAuth() {\n\n  useEffect(() => {\n    // register the component\n    // see: https://github.com/teamhanko/hanko/blob/main/frontend/elements/README.md#script\n    register({ shadow: true })\n      .catch((error) => {\n        // handle error\n      });\n  }, []);\n\n  return (\n    <hanko-auth api={api} lang={lang} />\n  );\n}\n')),(0,r.kt)("p",null,"The call to ",(0,r.kt)("inlineCode",{parentName:"p"},"register")," attempts to register the ",(0,r.kt)("inlineCode",{parentName:"p"},"<hanko-auth>")," element with the\nbrowser's ",(0,r.kt)("a",{parentName:"p",href:"https://developer.mozilla.org/de/docs/Web/API/CustomElementRegistry"},(0,r.kt)("inlineCode",{parentName:"a"},"CustomElementRegistry"))," through a\ncall to ",(0,r.kt)("inlineCode",{parentName:"p"},"window.customElements.define()"),".\nNext.js pre-renders pages on the server but the browser ",(0,r.kt)("inlineCode",{parentName:"p"},"window")," is not available during pre-rendering, so the custom\nelement registration would fail."),(0,r.kt)("p",null,"A solution for this is to use Next's ",(0,r.kt)("a",{parentName:"p",href:"https://nextjs.org/docs/advanced-features/dynamic-import"},"dynamic import")," feature\nto dynamically load the component on the client-side and disable server rendering for it:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'title="index.js" showLineNumbers',title:'"index.js"',showLineNumbers:!0},'import dynamic from "next/dynamic";\n\nexport default function Home() {\n  const HankoAuth = dynamic(\n    // replace with path to your component using the <hanko-auth> element\n    () => import(\'../components/HankoAuth\'),\n    { ssr: false },\n  )\n  return (\n    <Suspense fallback={"Loading ..."}>\n      <HankoAuth/>\n    </Suspense>\n  )\n}\n')),(0,r.kt)("h2",{id:"defining-login-callbacks"},"Defining login callbacks"),(0,r.kt)("p",null,"The ",(0,r.kt)("inlineCode",{parentName:"p"},"<hanko-auth>")," element dispatches a custom ",(0,r.kt)("inlineCode",{parentName:"p"},"hankoAuthSuccess")," event on successful login. React to this\nevent in order to, for example, redirect your users to protected pages in your application."),(0,r.kt)("p",null,"To do so, apply an event listener with an appropriate redirect callback:"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-jsx",metastring:'{2,9-20} title="HankoAuth.jsx" showLineNumbers',"{2,9-20}":!0,title:'"HankoAuth.jsx"',showLineNumbers:!0},'import React, { useEffect } from "react";\nimport { useRouter } from "next/router";\nimport { register } from "@teamhanko/hanko-elements/hanko-auth";\n\nconst api = process.env.NEXT_PUBLIC_HANKO_API!;\nconst lang = process.env.NEXT_PUBLIC_HANKO_LANG;\n\nexport default function HankoAuth() {\n  const router = useRouter();\n\n  const redirectAfterLogin = useCallback(() => {\n    // successfully logged in, redirect to a page in your application\n    router.replace("...");\n  }, [router]);\n\n  useEffect(() => {\n    document.addEventListener("hankoAuthSuccess", redirectAfterLogin);\n    return () =>\n      document.removeEventListener("hankoAuthSuccess", redirectAfterLogin);\n  }, [redirectAfterLogin]);\n\n  useEffect(() => {\n    // register the component\n    // see: https://github.com/teamhanko/hanko/blob/main/frontend/elements/README.md#script\n    register({ shadow: true })\n      .catch((error) => {\n        // handle error\n      });\n  }, []);\n\n  return (\n    <hanko-auth api={api} lang={lang} />\n  );\n}\n')),(0,r.kt)("h2",{id:"ui-customization"},"UI customization"),(0,r.kt)("p",null,"The styles of the ",(0,r.kt)("inlineCode",{parentName:"p"},"hanko-auth")," element can be customized using CSS variables and parts. See our guide\non customization ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/teamhanko/hanko/tree/main/frontend/elements#ui-customization"},"here"),"."),(0,r.kt)("h2",{id:"backend-request-authentication"},"Backend request authentication"),(0,r.kt)("p",null,"If you want to authenticate requests in your own backend, please view our ",(0,r.kt)("a",{parentName:"p",href:"/guides/backend"},"backend guide"),"."))}d.isMDXComponent=!0}}]);